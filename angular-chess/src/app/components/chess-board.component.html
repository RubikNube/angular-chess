<div class="board">
  <ng-container *ngFor="let rowIndex of playerPerspectiveRows$ | async">
    <ng-container *ngFor="let columnIndex of playerPerspectiveColumns$ | async">
      <app-chess-field
        [rowIndex]="rowIndex"
        [columnIndex]="columnIndex"
        [piece]="boardService.getPiece$(columnIndex, rowIndex) | async"
        [activePlayer]="boardService.activePlayer$ | async"
        [square]="
          highlightingService.getSquare$({ row: rowIndex, column: columnIndex })
            | async
        "
        (dragStart)="dragStart($event)"
        (dragEnd)="dragEnd($event)"
        #chessField
      ></app-chess-field>
    </ng-container>
  </ng-container>
</div>

<p-overlayPanel #op>
  <ng-template pTemplate>
    <p-listbox
      [options]="possiblePromotionPieces"
      (onClick)="selectPromotionPiece($event)"
    ></p-listbox>
  </ng-template>
</p-overlayPanel>

<div
  class="playerToMove playerToMove-color--{{
    boardService.activePlayer$ | async
  }}"
></div>

<p-toast position="top-center"></p-toast>
